<html>

<head>
<title>Pelimoottori</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

<script src="http://localhost:1339/socket.io/socket.io.js"> </script>
<script src="/javascript/common/log.js"> </script>
<script src="/javascript/screen/screenComs.js"> </script>
<script type="text/javascript" src="/javascript/rendering/glMatrix.js"     ></script>
<script type="text/javascript" src="/javascript/rendering/webglutils.js"   ></script>
<script type="text/javascript" src="/javascript/rendering/Renderer.js"     ></script>
<script type="text/javascript" src="/javascript/rendering/Shaderlib.js"    ></script>
<script type="text/javascript" src="/javascript/rendering/Material.js"     ></script>
<script type="text/javascript" src="/javascript/rendering/Texture.js"      ></script>
<script type="text/javascript" src="/javascript/rendering/Mesh.js"         ></script>
<script type="text/javascript" src="/javascript/rendering/testCube.js"     ></script>



<script id="pixel_Shader" type="x-shader/x-fragment">
    precision mediump float;

    varying vec2 vTextureCoord;

    uniform sampler2D uSampler;

    void main(void) 
    {
        gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
    }
</script>


<script id="vertex_Shader" type="x-shader/x-vertex">
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;
    
    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec2 vTextureCoord;
    
    void main(void) 
    {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vTextureCoord = aTextureCoord;
    }
</script>


<script type="text/javascript">


    var myEntity   = null;
    var renderer   = null;
      

    
    function tick() 
    {
        requestAnimFrame(tick);
            
     
        renderer.draw_Scene(  myEntity );
    }
    
    
    function Start() 
    {
        renderer       = new Renderer( document.getElementById("Canvas")             );
        var myShader   = new   Shader( renderer.gl , "vertex_Shader", "pixel_Shader" );
        var myTexture  = new  Texture( renderer.gl , "/data/texture.png"              );  
        var myMaterial = new Material( myShader    , myTexture                       );
        myEntity       =    test_Cube( renderer.gl , myMaterial                      );
        
        myEntity.move( [0,0,-30] );
        
        var socket = io.connect('http://localhost:1339');

	socket.on('message', function(data) 
        {
		
                myEntity.set_Position( [data.xCoordinate/100, data.yCoordinate/100, -15] );             
        });
                
 
              
        tick();     
    }


</script>


</head>


<body onload="Start();">
   
    <canvas id="Canvas" style="border: none;" width="1024" height="768"></canvas>

    <br/>
  
</body>

</html>
